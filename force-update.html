<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>å¼·åˆ¶æ›´æ–°æ™‚é–“è»¸</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            margin: 0;
            background: linear-gradient(180deg, #141824 0%, #1a1f2e 100%);
        }
        .container {
            background: white;
            padding: 40px;
            border-radius: 15px;
            box-shadow: 0 10px 40px rgba(0,0,0,0.2);
            text-align: center;
            max-width: 600px;
        }
        h1 {
            color: #333;
            margin-bottom: 20px;
        }
        button {
            background: linear-gradient(135deg, #1e3c72 0%, #2a5298 100%);
            color: white;
            border: none;
            padding: 15px 30px;
            font-size: 18px;
            border-radius: 8px;
            cursor: pointer;
            margin: 10px;
            transition: all 0.3s;
        }
        button:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(30, 60, 114, 0.4);
        }
        .status {
            margin-top: 20px;
            padding: 20px;
            border-radius: 8px;
            background: #f0f4f8;
            color: #333;
            font-size: 14px;
            text-align: left;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeeba;
        }
        code {
            background: #f8f9fa;
            padding: 2px 6px;
            border-radius: 3px;
            font-family: 'Courier New', monospace;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>ğŸ”§ å¼·åˆ¶æ›´æ–°æ™‚é–“è»¸å·¥å…·</h1>
        <p>Chrome å¿«å–å•é¡Œä¿®å¾©å·¥å…·</p>
        
        <button onclick="forceUpdate()">ğŸš€ å¼·åˆ¶æ›´æ–°ä¸¦é–‹å•Ÿæ–°æ™‚é–“è»¸</button>
        
        <div id="status" class="status">
            <strong>ä½¿ç”¨èªªæ˜ï¼š</strong><br>
            1. é»æ“Šä¸Šæ–¹æŒ‰éˆ•<br>
            2. ç³»çµ±æœƒå®Œå…¨æ¸…é™¤æ‰€æœ‰å¿«å–<br>
            3. è‡ªå‹•é–‹å•Ÿå…¨æ–°çš„æ™‚é–“è»¸é é¢<br>
            4. ç¢ºä¿è¼‰å…¥æœ€æ–°çš„è³‡æ–™
        </div>
    </div>

    <script>
        function forceUpdate() {
            const status = document.getElementById('status');
            status.className = 'status warning';
            status.innerHTML = '<strong>ğŸ”„ è™•ç†ä¸­...</strong><br>';
            
            // 1. æ¸…é™¤ localStorage
            localStorage.clear();
            status.innerHTML += 'âœ“ localStorage å·²æ¸…é™¤<br>';
            
            // 2. æ¸…é™¤ sessionStorage
            sessionStorage.clear();
            status.innerHTML += 'âœ“ sessionStorage å·²æ¸…é™¤<br>';
            
            // 3. æ¸…é™¤ IndexedDB
            if (window.indexedDB) {
                indexedDB.databases().then(databases => {
                    databases.forEach(db => {
                        indexedDB.deleteDatabase(db.name);
                    });
                });
                status.innerHTML += 'âœ“ IndexedDB å·²æ¸…é™¤<br>';
            }
            
            // 4. æ¸…é™¤ Service Workers
            if ('serviceWorker' in navigator) {
                navigator.serviceWorker.getRegistrations().then(function(registrations) {
                    for(let registration of registrations) {
                        registration.unregister();
                    }
                });
                status.innerHTML += 'âœ“ Service Workers å·²æ¸…é™¤<br>';
            }
            
            // 5. æ¸…é™¤æ‰€æœ‰ cookies
            document.cookie.split(";").forEach(function(c) { 
                document.cookie = c.replace(/^ +/, "").replace(/=.*/, "=;expires=" + new Date().toUTCString() + ";path=/"); 
            });
            status.innerHTML += 'âœ“ Cookies å·²æ¸…é™¤<br>';
            
            status.innerHTML += '<br><strong>âœ… æ‰€æœ‰å¿«å–å·²æ¸…é™¤ï¼</strong><br>';
            status.innerHTML += 'æ­£åœ¨é–‹å•Ÿæ–°è¦–çª—...';
            status.className = 'status success';
            
            // 6. é–‹å•Ÿæ–°çš„ç„¡ç—•è¦–çª—ï¼ˆå»ºè­°ï¼‰
            setTimeout(() => {
                // ä½¿ç”¨æ™‚é–“æˆ³ç¢ºä¿ä¸æœƒè¢«å¿«å–
                const timestamp = new Date().getTime();
                const newUrl = `http://localhost:8888/index.html?nocache=${timestamp}&forceRefresh=true`;
                
                // é–‹å•Ÿæ–°è¦–çª—
                const newWindow = window.open(newUrl, '_blank');
                
                if (newWindow) {
                    status.innerHTML += '<br><br>âœ… æ–°è¦–çª—å·²é–‹å•Ÿï¼<br>';
                    status.innerHTML += '<small>å¦‚æœé‚„æ˜¯çœ‹åˆ°èˆŠç‰ˆï¼Œè«‹ï¼š<br>';
                    status.innerHTML += '1. é—œé–‰æ‰€æœ‰ Chrome è¦–çª—<br>';
                    status.innerHTML += '2. é‡æ–°é–‹å•Ÿ Chrome<br>';
                    status.innerHTML += '3. ä½¿ç”¨ç„¡ç—•æ¨¡å¼é–‹å•Ÿæ™‚é–“è»¸</small>';
                } else {
                    status.innerHTML += '<br><br>âš ï¸ ç„¡æ³•è‡ªå‹•é–‹å•Ÿæ–°è¦–çª—<br>';
                    status.innerHTML += `è«‹æ‰‹å‹•è¤‡è£½æ­¤é€£çµï¼š<br>`;
                    status.innerHTML += `<code>${newUrl}</code>`;
                }
            }, 1000);
        }
        
        // é¡¯ç¤ºç•¶å‰ localStorage ç‹€æ…‹
        window.onload = function() {
            const hasData = localStorage.getItem('timelineEvents');
            if (hasData) {
                const status = document.getElementById('status');
                status.innerHTML = '<strong>âš ï¸ åµæ¸¬åˆ°èˆŠç‰ˆå¿«å–è³‡æ–™</strong><br>' + status.innerHTML;
            }
        };
    </script>
</body>
</html>